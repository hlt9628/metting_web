<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>面试分析报告</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>

  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            secondary: '#36BFFA',
            success: '#00B42A',
            warning: '#FF7D00',
            danger: '#F53F3F',
            neutral: {
              100: '#F2F3F5',
              200: '#E5E6EB',
              300: '#C9CDD4',
              400: '#86909C',
              500: '#4E5969',
              600: '#272E3B',
              700: '#1D2129',
            }
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
          boxShadow: {
            'card': '0 4px 20px rgba(0, 0, 0, 0.08)',
            'card-hover': '0 8px 30px rgba(0, 0, 0, 0.12)',
          }
        },
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .group-hover\:scale-110:hover {
        transform: scale(1.1);
      }
      .text-gradient {
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }
      .bg-card {
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      .animate-slide-up {
        animation: slideUp 0.6s ease-out;
      }
      .score-badge {
        @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium transition-all duration-300;
      }
      .score-badge-high {
        @apply score-badge bg-success/10 text-success;
      }
      .score-badge-medium {
        @apply score-badge bg-warning/10 text-warning;
      }
      .score-badge-low {
        @apply score-badge bg-danger/10 text-danger;
      }
      .section-card {
        @apply bg-card rounded-xl shadow-card p-6 transition-all duration-300 hover:shadow-card-hover border border-neutral-100;
      }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>
<body class="bg-neutral-100 font-inter text-neutral-700 min-h-screen">
<!-- 顶部导航 -->
<!-- 顶部导航 -->
<nav class="bg-white shadow-sm sticky top-0 z-10">
  <div class="container mx-auto px-4 py-3 flex justify-between items-center">
    <div class="flex items-center space-x-2">
      <i class="fa fa-file-text-o text-primary text-2xl"></i>
      <h1 class="text-xl font-bold text-neutral-700">面试分析系统</h1>
    </div>
    <div class="flex items-center space-x-8">
      <!-- 醒目化处理的导航按钮 -->
      <div class="flex items-center space-x-6">
        <a href="./meeting_report.html" class="text-primary hover:text-primary/80 focus:text-primary/80 group relative">
          <i class="fa fa-file-text-o mr-1 text-lg group-hover:scale-110 transition-transform"></i>
          <span class="hidden md:inline font-semibold">面试报告</span>
          <span class="absolute bottom-0 left-1/2 transform -translate-x-1/2 h-0.5 w-0 bg-primary transition-all group-hover:w-8"></span>
        </a>

        <a href="./total_report.html" class="text-primary hover:text-primary/80 focus:text-primary/80 group relative">
          <i class="fa fa-line-chart mr-1 text-lg group-hover:scale-110 transition-transform"></i>
          <span class="hidden md:inline font-semibold">总体报告</span>
          <span class="absolute bottom-0 left-1/2 transform -translate-x-1/2 h-0.5 w-0 bg-primary transition-all group-hover:w-10"></span>
        </a>
      </div>

      <!-- 原有功能按钮 -->
      <div class="flex items-center space-x-4">
        <button class="text-neutral-500 hover:text-primary transition-colors" onclick="window.location.href='../home/home.html'">
          <i class="fa fa-home"></i>
          <span class="hidden md:inline ml-1">返回主页</span>
        </button>
        <button class="text-neutral-500 hover:text-primary transition-colors">
          <i class="fa fa-question-circle"></i>
          <span class="hidden md:inline ml-1">帮助</span>
        </button>
        <button class="text-neutral-500 hover:text-primary transition-colors">
          <i class="fa fa-user-circle"></i>
          <span class="hidden md:inline ml-1">面试官</span>
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- 主要内容 -->
<main class="container mx-auto px-4 py-8">
  <!-- 报告标题 -->
  <div class="mb-8 text-center animate-fade-in">
    <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-neutral-700">面试分析报告</h2>
    <p class="text-neutral-500 mt-2">基于AI的面试评估与分析</p>
  </div>

  <!-- 候选人信息卡片 -->
  <div id="candidate-info" class="section-card mb-8 animate-slide-up" style="animation-delay: 0.1s">
    <!-- 内容将由JS填充 -->
  </div>

  <!-- 雷达图与总体评估 -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
    <!-- 雷达图 -->
    <div class="section-card lg:col-span-1 animate-slide-up" style="animation-delay: 0.2s">
      <h3 class="text-lg font-bold text-neutral-700 mb-4 flex items-center">
        <i class="fa fa-line-chart text-primary mr-2"></i>能力评估雷达图
      </h3>
      <div class="h-64">
        <canvas id="radarChart"></canvas>
      </div>
    </div>

    <!-- 总体评估 -->
    <div id="overall-assessment" class="section-card lg:col-span-2 animate-slide-up" style="animation-delay: 0.3s">
      <!-- 内容将由JS填充 -->
    </div>
  </div>

  <!-- 详细评估项 -->
  <div id="assessment-items" class="grid grid-cols-1 gap-6 mb-8">
    <!-- 内容将由JS填充 -->
  </div>



  <!-- 底部操作 -->
  <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 mb-8 animate-slide-up" style="animation-delay: 1s">
    <div id="report-time" class="text-neutral-500">
      <!-- 内容将由JS填充 -->
    </div>
    <div class="flex space-x-3">
      <button class="px-4 py-2 border border-neutral-300 rounded-lg text-neutral-700 hover:bg-neutral-50 transition-colors">
        <i class="fa fa-print mr-1"></i> 打印报告
      </button>
      <button class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors flex items-center">
        <i class="fa fa-download mr-1"></i> 导出PDF
      </button>
    </div>
  </div>
</main>

<!-- 页脚 -->
<footer class="bg-white border-t border-neutral-200 py-6">
  <div class="container mx-auto px-4">
    <div class="flex flex-col md:flex-row justify-between items-center">
      <div class="mb-4 md:mb-0">
        <p class="text-neutral-500 text-sm">© 2025 面试分析系统. 保留所有权利.</p>
      </div>
      <div class="flex space-x-4">
        <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
          <i class="fa fa-question-circle"></i> 帮助中心
        </a>
        <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
          <i class="fa fa-file-text-o"></i> 使用条款
        </a>
        <a href="#" class="text-neutral-500 hover:text-primary transition-colors">
          <i class="fa fa-shield"></i> 隐私政策
        </a>
      </div>
    </div>
  </div>
</footer>

<!-- JavaScript -->
<script>
  let resume_name =null
  let resume_position =null
  let resume_strengths = []
  let resume_improvements=[]
  let resume_competitiveness=[]
  let knowledge_positiveItems=[]
  let knowledge_negativeItems=[]
  let communication_positiveItems=[]
  let communication_negativeItems=[]
  let skills_positiveItems=[]
  let skills_negativeItems=[]
  let logic_positiveItems=[]
  let logic_negativeItems=[]
  let innovation_positiveItems=[]
  let innovation_negativeItems=[]
  let knowledgeScore=null
  let communicationScore=null
  let logicScore=null
  let skillsScore=null
  let innovationScore=null
  let processedLines = [];
  let userId = null;
  let resumeReport = null;
  let mettingReport = null; // 注意：Java 中可能拼写错误，应为 meetingReport？
  let knowledgeMark = null;
  let knowledgeMarkTotal = null;
  let skillMark = null;
  let skillMarkTotal = null;
  let logisticMark = null;
  let logisticMarkTotal = null;
  let createMark = null;
  let createMarkTotal = null;
  let lunguageMark = null;
  let lunguageMarkTotal = null;
  let markTotal = null;
  var time = new Date();
    time = time.toLocaleString()
  let index=0
  const analysisResult = localStorage.getItem('analysisResult');
  const lines = analysisResult.split('\n');
  console.log(lines.length);
  const keywords=["**评测对象**","**目标岗位**","**优势**","**待改进项**","**竞争力定位**","（一）专业知识水平","正向加分项","负向减分项","**得分**","（二）技能匹配度","（三）语言表达能力","（四）逻辑思维能力","（五）创新能力"]
  for (let i = 0; i < lines.length; i++){
    const line = lines[i].trim();
    processedLines = lines.map(line => line.trim());
  }
  console.log(processedLines.length)
  for (index=0;index<processedLines.length;index++){
    const line = processedLines[index];
    checkLine(line,keywords)
  }
  function checkLine(line, keywords) {
    switch(true){
      case line.includes(keywords[0]):
        console.log("匹配到"+keywords[0])
        resume_name =line.split("：")[1].trim()
        console.log(resume_name)
        break;
      case line.includes(keywords[1]):
        console.log("匹配到"+keywords[1])
        resume_position =line.split("：")[1].trim()
        console.log(resume_position)
        break;
      case line.includes(keywords[2]):
        console.log("匹配到"+keywords[2])
        let strengthsIndex = index+1;
        while (strengthsIndex < processedLines.length) {
          const line = processedLines[strengthsIndex];

          // 如果行不包含任何关键词，则处理它
          if (!keywords.some(keyword => line.includes(keyword))) {
            // 处理逻辑：分割并取第二部分，移除星号
            const parts = line.split(".");
            if (parts.length > 1) { // 确保有第二部分
              const processedLine = parts[1].trim().replaceAll("*", "");
              resume_strengths.push(processedLine)

              // 这里可以添加进一步的处理逻辑，例如保存结果
            }
            strengthsIndex++; // 继续处理下一行
          } else {
            break; // 遇到关键词，停止处理
          }
        }
        console.log(resume_strengths)
        break;
      case line.includes(keywords[3]):
        console.log("匹配到"+keywords[3])
        let improvementsIndex = index+1;
        while (improvementsIndex < processedLines.length) {
          const line = processedLines[improvementsIndex];

          // 如果行不包含任何关键词，则处理它
          if (!keywords.some(keyword => line.includes(keyword))) {
            // 处理逻辑：分割并取第二部分，移除星号
            const parts = line.split(".");
            if (parts.length > 1) { // 确保有第二部分
              const processedLine = parts[1].trim().replaceAll("*", "");
              resume_improvements.push(processedLine)

              // 这里可以添加进一步的处理逻辑，例如保存结果
            }
            improvementsIndex++; // 继续处理下一行
          } else {
            break; // 遇到关键词，停止处理
          }
        }
        console.log(resume_improvements)
        break;
      case line.includes(keywords[4]):
        console.log("匹配到"+keywords[4])
        let competitivenessIndex = index+1;
        while (competitivenessIndex < processedLines.length) {
          const line = processedLines[competitivenessIndex];
          let processedLine = line
          // 如果行不包含任何关键词，则处理它
          if (!keywords.some(keyword => line.includes(keyword))) {
            if (line.includes("*")){
              processedLine  = processedLine.replaceAll("*","")
              resume_competitiveness.push(processedLine)
            }
            else{
              resume_competitiveness.push(processedLine)
            }
              // 这里可以添加进一步的处理逻辑，例如保存结果
            competitivenessIndex++; // 继续处理下一行
          } else {
            break; // 遇到关键词，停止处理
          }
        }
        console.log(resume_competitiveness)
        break;
      case line.includes(keywords[5]):
        console.log("匹配到"+keywords[5]);
        let knowledgeIndex = index + 1;
        let knowledgePositiveSection = false;
        let knowledgeNegativeSection = false;

        while (knowledgeIndex < processedLines.length) {
          const currentLine = processedLines[knowledgeIndex];

          // 检测是否进入正向加分项部分
          if (currentLine.includes(keywords[6])) {
            knowledgePositiveSection = true;
            knowledgeNegativeSection = false;
            knowledgeIndex++;
            continue;
          }

          // 检测是否进入负向减分项部分
          if (currentLine.includes(keywords[7])) {
            knowledgePositiveSection = false;
            knowledgeNegativeSection = true;
            knowledgeIndex++;
            continue;
          }

          // 处理正向加分项
          if (knowledgePositiveSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              knowledge_positiveItems.push(parts[1].trim());
              console.log("正向加分项:", parts[1].trim());
            }
          }

          // 处理负向减分项
          if (knowledgeNegativeSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              knowledge_negativeItems.push(parts[1].trim());
              console.log("负向减分项:", parts[1].trim());
            }
          }

          // 处理得分
          if (currentLine.includes(keywords[8])) {
            const parts = currentLine.split("：");
            if (parts.length > 1) {
              knowledgeScore = parts[1].trim().substring(0, 5);
              console.log("得分:", knowledgeScore);
            }
            knowledgePositiveSection = false;
            knowledgeNegativeSection = false;
          }

          // 检测是否离开当前部分
          if (currentLine.includes(keywords[9])) {
            break;
          }

          knowledgeIndex++;
        }
        break;
      case line.includes(keywords[10]):
        console.log("匹配到"+keywords[10]);
        let communicationIndex = index + 1;
        let communicationPositiveSection = false;
        let communicationNegativeSection = false;

        while (communicationIndex < processedLines.length) {
          const currentLine = processedLines[communicationIndex];

          // 检测是否进入正向加分项部分
          if (currentLine.includes(keywords[6])) {
            communicationPositiveSection  = true;
            communicationNegativeSection = false;
            communicationIndex++;
            continue;
          }

          // 检测是否进入负向减分项部分
          if (currentLine.includes(keywords[7])) {
            communicationPositiveSection  = false;
            communicationNegativeSection = true;
            communicationIndex++;
            continue;
          }

          // 处理正向加分项
          if (communicationPositiveSection  && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              communication_positiveItems.push(parts[1].trim());
              console.log("正向加分项:", parts[1].trim());
            }
          }

          // 处理负向减分项
          if (communicationNegativeSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              communication_negativeItems.push(parts[1].trim());
              console.log("负向减分项:", parts[1].trim());
            }
          }

          // 处理得分
          if (currentLine.includes(keywords[8])) {
            const parts = currentLine.split("：");
            if (parts.length > 1) {
              communicationScore = parts[1].trim().substring(0, 5);
              console.log("得分:", communicationScore);
            }
            communicationPositiveSection  = false;
            communicationNegativeSection = false;
          }

          // 检测是否离开当前部分
          if (currentLine.includes(keywords[11])) {
            break;
          }

          communicationIndex++;
        }
        break;
      case line.includes(keywords[9]):
        console.log("匹配到"+keywords[9]);
        let skillsIndex = index + 1;
        let skillsPositiveSection = false;
        let skillsNegativeSection = false;

        while (skillsIndex < processedLines.length) {
          const currentLine = processedLines[skillsIndex];

          // 检测是否进入正向加分项部分
          if (currentLine.includes(keywords[6])) {
            skillsPositiveSection = true;
            skillsNegativeSection = false;
            skillsIndex++;
            continue;
          }

          // 检测是否进入负向减分项部分
          if (currentLine.includes(keywords[7])) {
            skillsPositiveSection = false;
            skillsNegativeSection = true;
            skillsIndex++;
            continue;
          }

          // 处理正向加分项
          if (skillsPositiveSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              skills_positiveItems.push(parts[1].trim());
              console.log("正向加分项:", parts[1].trim());
            }
          }

          // 处理负向减分项
          if (skillsNegativeSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              skills_negativeItems.push(parts[1].trim());
              console.log("负向减分项:", parts[1].trim());
            }
          }

          // 处理得分
          if (currentLine.includes(keywords[8])) {
            const parts = currentLine.split("：");
            if (parts.length > 1) {
              skillsScore = parts[1].trim().substring(0, 5);
              console.log("得分:",skillsScore);
            }
            skillsPositiveSection = false;
            skillsNegativeSection = false;
          }

          // 检测是否离开当前部分
          if (currentLine.includes(keywords[10])) {
            break;
          }

          skillsIndex++;
        }
        break;
      case line.includes(keywords[11]):
        console.log("匹配到"+keywords[11]);
        let logicIndex = index + 1;
        let logicPositiveSection = false;
        let logicNegativeSection = false;

        while (logicIndex < processedLines.length) {
          const currentLine = processedLines[logicIndex];

          // 检测是否进入正向加分项部分
          if (currentLine.includes(keywords[6])) {
            logicPositiveSection = true;
            logicNegativeSection = false;
            logicIndex++;
            continue;
          }

          // 检测是否进入负向减分项部分
          if (currentLine.includes(keywords[7])) {
            logicPositiveSection = false;
            logicNegativeSection = true;
            logicIndex++;
            continue;
          }

          // 处理正向加分项
          if (logicPositiveSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              logic_positiveItems.push(parts[1].trim());
              console.log("正向加分项:", parts[1].trim());
            }
          }

          // 处理负向减分项
          if (logicNegativeSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              logic_negativeItems.push(parts[1].trim());
              console.log("负向减分项:", parts[1].trim());
            }
          }

          // 处理得分
          if (currentLine.includes(keywords[8])) {
            const parts = currentLine.split("：");
            if (parts.length > 1) {
              logicScore = parts[1].trim().substring(0, 5);
              console.log("得分:",logicScore);
            }
            logicPositiveSection = false;
            logicNegativeSection = false;
          }

          // 检测是否离开当前部分
          if (currentLine.includes(keywords[12])) {
            break;
          }
          logicIndex++;
        }
        break;
      case line.includes(keywords[12]):
        console.log("匹配到"+keywords[12]);
        let innovationIndex = index + 1;
        let innovationPositiveSection = false;
        let innovationNegativeSection = false;

        while (innovationIndex < processedLines.length) {
          const currentLine = processedLines[innovationIndex];

          // 检测是否进入正向加分项部分
          if (currentLine.includes(keywords[6])) {
            innovationPositiveSection = true;
            innovationNegativeSection = false;
            innovationIndex++;
            continue;
          }

          // 检测是否进入负向减分项部分
          if (currentLine.includes(keywords[7])) {
            innovationPositiveSection = false;
            innovationNegativeSection = true;
            innovationIndex++;
            continue;
          }

          // 处理正向加分项
          if (innovationPositiveSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              innovation_positiveItems.push(parts[1].trim());
              console.log("正向加分项:", parts[1].trim());
            }
          }

          // 处理负向减分项
          if (innovationNegativeSection && !currentLine.includes(keywords[8])) {
            const parts = currentLine.split(".");
            if (parts.length > 1) {
              innovation_negativeItems.push(parts[1].trim());
              console.log("负向减分项:", parts[1].trim());
            }
          }

          // 处理得分
          if (currentLine.includes(keywords[8])) {
            const parts = currentLine.split("：");
            if (parts.length > 1) {
              innovationScore = parts[1].trim().substring(0, 5);
              console.log("得分:",innovationScore);
            }
            innovationPositiveSection = false;
            innovationNegativeSection = false;
            return;
          }
          // 检测是否离开当前部分
          if (currentLine.includes(keywords[12])) {
            break;
          }
          innovationIndex++;
        }
        break;
      default:
      console.log("无关行")
    }
  }
  // 自定义数据变量
  const interviewData = {
    candidate: {
      name:resume_name ,
      position: resume_position,
      photoUrl: "https://picsum.photos/seed/candidate/100/100",
      interviewDate: time,
      interviewer: "李经理",
      interviewType: "线上视频",
      totalScore: "85/100"
    },
    overall: {
      strengths:resume_strengths,
      improvements: resume_improvements,
      competitiveness: resume_competitiveness
    },
    assessmentItems: [
      {
        id: "knowledge",
        title: "专业知识水平",
        weight: "30%",
        score: knowledgeScore,
        positiveItems: knowledge_positiveItems,
        negativeItems: knowledge_negativeItems
      },
      {
        id: "communication",
        title: "语言表达能力",
        weight: "15%",
        score: "13/15",
        positiveItems: communication_positiveItems,
        negativeItems: communication_negativeItems
      },
      {
        id: "skills",
        title: "技能匹配度",
        weight: "25%",
        score: "23/25",
        positiveItems: skills_positiveItems ,
        negativeItems: skills_negativeItems
      },
      {
        id: "logic",
        title: "逻辑思维能力",
        weight: "20%",
        score: logicScore,
        positiveItems: logic_positiveItems,
        negativeItems: logic_negativeItems
      },
      {
        id: "innovation",
        title: "创新能力",
        weight: "10%",
        score: innovationScore,
        positiveItems: innovation_positiveItems,
        negativeItems: innovation_negativeItems
      }
    ]
  };

  // 初始化页面
  document.addEventListener('DOMContentLoaded', function() {
    // 填充候选人信息
    const candidateInfo = document.getElementById('candidate-info');
    candidateInfo.innerHTML = `
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div class="flex items-center mb-4 md:mb-0">
                        <img src="${interviewData.candidate.photoUrl}" alt="候选人照片" class="w-16 h-16 rounded-full object-cover border-2 border-primary shadow-md">
                        <div class="ml-4">
                            <h3 class="text-xl font-bold text-neutral-700">${interviewData.candidate.name}</h3>
                            <p class="text-neutral-500">应聘职位：${interviewData.candidate.position}</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 w-full md:w-auto">
                        <div class="text-center">
                            <p class="text-neutral-500 text-sm">面试日期</p>
                            <p class="font-semibold">${interviewData.candidate.interviewDate}</p>
                        </div>
                        <div class="text-center">
                            <p class="text-neutral-500 text-sm">面试官</p>
                            <p class="font-semibold">${interviewData.candidate.interviewer}</p>
                        </div>
                        <div class="text-center">
                            <p class="text-neutral-500 text-sm">面试方式</p>
                            <p class="font-semibold">${interviewData.candidate.interviewType}</p>
                        </div>
                        <div class="text-center">
                            <p class="text-neutral-500 text-sm">总分</p>
                            <p class="font-bold text-primary">${interviewData.candidate.totalScore}</p>
                        </div>
                    </div>
                </div>
            `;

    // 填充总体评估
    const overallAssessment = document.getElementById('overall-assessment');
    overallAssessment.innerHTML = `
                <h3 class="text-lg font-bold text-neutral-700 mb-4 flex items-center">
                    <i class="fa fa-comment text-primary mr-2"></i>总体评估
                </h3>
                <div class="space-y-4">
                    <div>
                        <h4 class="font-semibold text-neutral-600">优势：</h4>
                       <ul class="list-disc list-inside text-neutral-700 space-y-1">
                        ${interviewData.overall.strengths.map(strength => `
                          <li>${strength}</li>
                        `).join('')}
                      </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-neutral-600">待改进项：</h4>
                        <ul class="list-disc list-inside text-neutral-700 space-y-1">
                          ${interviewData.overall.improvements.map(improvement => `
                            <li>${improvement}</li>
                          `).join('')}
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-neutral-600">竞争力定位：</h4>
                       <ul class="list-disc list-inside text-neutral-700 space-y-1">
                        ${interviewData.overall.competitiveness.map(item => `
                          <li>${item}</li>
                        `).join('')}
                      </ul>
                    </div>
                </div>
            `;

    // 填充详细评估项
    const assessmentItems = document.getElementById('assessment-items');
    let assessmentHTML = '';

    // 图标映射
    const icons = {
      knowledge: 'fa-book',
      communication: 'fa-commenting',
      skills: 'fa-cogs',
      logic: 'fa-puzzle-piece',
      innovation: 'fa-lightbulb-o'
    };

    interviewData.assessmentItems.forEach((item, index) => {
      // 根据得分计算徽章样式
      const scoreParts = item.score.split('/');
      const scorePercentage = (parseInt(scoreParts[0]) / parseInt(scoreParts[1])) * 100;
      let badgeClass = 'score-badge-high';
      if (scorePercentage < 70) badgeClass = 'score-badge-low';
      else if (scorePercentage < 85) badgeClass = 'score-badge-medium';

      // 构建正向加分项列表
      let positiveHTML = '';
      item.positiveItems.forEach(positive => {
        positiveHTML += `<li>${positive}</li>`;
      });

      // 构建负向减分项列表
      let negativeHTML = '';
      item.negativeItems.forEach(negative => {
        negativeHTML += `<li>${negative}</li>`;
      });

      // 计算动画延迟
      const animationDelay = 0.4 + (index * 0.1);

      assessmentHTML += `
                    <div class="section-card animate-slide-up" style="animation-delay: ${animationDelay}s">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-neutral-700 flex items-center">
                                <i class="fa ${icons[item.id]} text-primary mr-2"></i>${item.title}
                                <span class="ml-2 text-sm font-normal text-neutral-500">（权重：${item.weight}）</span>
                            </h3>
                            <span class="${badgeClass}">${item.score}</span>
                        </div>
                        <div class="space-y-4">
                            <div class="bg-neutral-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-success mb-2 flex items-center">
                                    <i class="fa fa-plus-circle mr-1"></i>正向加分项：
                                </h4>
                                <ul class="list-disc list-inside space-y-2 text-neutral-700">
                                    ${positiveHTML}
                                </ul>
                            </div>
                            <div class="bg-neutral-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-danger mb-2 flex items-center">
                                    <i class="fa fa-minus-circle mr-1"></i>负向减分项：
                                </h4>
                                <ul class="list-disc list-inside space-y-2 text-neutral-700">
                                    ${negativeHTML}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
    });

    assessmentItems.innerHTML = assessmentHTML;

    // 初始化雷达图
    const ctx = document.getElementById('radarChart').getContext('2d');

    // 准备雷达图数据
    const radarLabels = interviewData.assessmentItems.map(item => item.title);
    const radarData = interviewData.assessmentItems.map(item => {
      const [score, max] = item.score.split('/');
      return parseInt(score);
    });

    const radarMax = interviewData.assessmentItems.map(item => {
      const [score, max] = item.score.split('/');
      return parseInt(max);
    });

    // 计算最大可能值作为雷达图的最大值
    const maxPossible = Math.max(...radarMax);

    const radarChart = new Chart(ctx, {
      type: 'radar',
      data: {
        labels: radarLabels,
        datasets: [{
          label: '候选人得分',
          data: radarData,
          backgroundColor: 'rgba(22, 93, 255, 0.2)',
          borderColor: 'rgba(22, 93, 255, 0.8)',
          pointBackgroundColor: 'rgba(22, 93, 255, 1)',
          pointBorderColor: '#fff',
          pointHoverBackgroundColor: '#fff',
          pointHoverBorderColor: 'rgba(22, 93, 255, 1)'
        }, {
          label: '岗位要求',
          data: radarMax,
          backgroundColor: 'rgba(201, 205, 212, 0.2)',
          borderColor: 'rgba(201, 205, 212, 0.8)',
          pointBackgroundColor: 'rgba(201, 205, 212, 1)',
          pointBorderColor: '#fff',
          pointHoverBackgroundColor: '#fff',
          pointHoverBorderColor: 'rgba(201, 205, 212, 1)'
        }]
      },
      options: {
        elements: {
          line: {
            borderWidth: 2
          }
        },
        scales: {
          r: {
            angleLines: {
              display: true
            },
            suggestedMin: 0,
            suggestedMax: maxPossible,
            ticks: {
              stepSize: maxPossible / 6
            }
          }
        },
        plugins: {
          legend: {
            position: 'bottom'
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.dataset.label || '';
                const value = context.raw;
                const max = context.datasetIndex === 0 ? radarMax[context.dataIndex] : value;
                return `${label}: ${value}/${max}`;
              }
            }
          }
        }
      }
    });

  
    // 监听滚动，为元素添加动画
    const animateOnScroll = () => {
      const elements = document.querySelectorAll('.animate-slide-up, .animate-fade-in');

      elements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        const windowHeight = window.innerHeight;

        if (elementTop < windowHeight * 0.85) {
          element.style.opacity = '1';
          element.style.transform = 'translateY(0)';
        }
      });
    };

    // 初始设置动画样式
    document.querySelectorAll('.animate-slide-up').forEach(el => {
      el.style.opacity = '0';
      el.style.transform = 'translateY(20px)';
      el.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
    });

    document.querySelectorAll('.animate-fade-in').forEach(el => {
      el.style.opacity = '0';
      el.style.transition = 'opacity 0.5s ease-in-out';
    });

    // 初始执行一次
    setTimeout(animateOnScroll, 100);

    // 滚动时执行
    window.addEventListener('scroll', animateOnScroll);
  });
</script>

</body>
</html>
